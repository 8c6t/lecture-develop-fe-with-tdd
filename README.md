# 프론트엔드 개발과 TDD 

## 동기부여 

### 아리송한 상황 

* 클라이언트 측 자바스크립트를 다루는 것은 복잡함 
  * 서버쪽은 노드JS 버전을 마음대로 변경할 수 있다 
  * 클라이언트 쪽은 사용자가가 사용할 브라우져 버전을 강제할 수 없다 
* 자바스크립트 언어 자체의 특징 
  * console.log 함수가 매우 쉽게 덮어 쓰여질 수 있다 
  * 이것은 의도된 언어 스펙이지만 개발자들이 실수할 가능성이 높다 
* 타입
  * '1' + 1 = '11'
  * '2' * 3 = 6
  * 1 + '2' + 3 * 4 = '1212' 
* 이러한 문제를 극복하는 방법으로 테스트주도개발(TDD)을 알아보자 

## 준비

### 자스민 프레임웍

* 자스민은 피보탈 랩스에서 만든 BDD(Behavior Driven Development) 프레임웍크로서 자동화된 단위 테스트 도구
* 단위 테스트(unit test)란 코드의 기능 단위(funtionality unit)를 테스트 하는 것을 말한다 
  * 무엇이 기능인가? 결정하기 쉽지 않음 
  * TDD를 다른 관점에서 바라본 BDD라는 해결책을 제시 
* BDD
  * 유저 스토리 개념을 끌어들인 테스트 작성법 
  * 예를 들어 어떤 버튼을 클릭하면 경고 창을 띄우는 유저 스토리를 생각해 보자 
    * Given: 초기 상황
    * When: 어떤 이벤트가 발생 
    * Then: 후속 결과를 기대 
  * ```js
    describe('어떤 버튼은', ()=> {
      describe('클릭했을 때', ()=> {
        it('경고창을 띄운다', ()=> {

        })
      })
    })
    ```
  * 테스트 단위를 스팩(spec)이라고 함
    * 자스민에서는 it 함수로 만든다 

### 설치 

* [getting_started](https://jasmine.github.io/pages/getting_started.html)
* 두 가지 설치 방법: 스탠드어론, 노드JS 
  * 스탠드어론으로 설치 하겠음 
* 러너
  * 자스민 코드와 소스 파일, 스펙을  파일을 참조하는 html 파일 
  * setting/index.html 파일 확인 
* 헬로월드 
  * `checkout` 


## 돔 접근 테스트 

### ClickCounter 예제 

#### 테스트하기 어려운 UI 코드 

* 관심사가 분리되지 않았음 
* 재사용성이 떨어짐 
* 자바스크립트를 별도로 빼내면 다른 곳에서도 재사용할수 있고 테스트성도 좋아짐
* UI에서 완전히 떼어놓고 코드를 모듈화 시키면 비즈니스 로직만 테스트할 수 있음
* ```
  git checkout -f 1c6e723
  ```
  
#### 테스트하기 쉬운 UI 코드 

##### ClickCountDisplay 모듈 로직 코드 테스팅

* 버튼 클릭 이벤트 처리기의 역할
  * 총 클릭 횟수를 저장한 변수값을 증가한다 
  * 돔 업데이트 함수 호출   

* ```
  git checkout -f 
  ```

##### DOM을 바꾸는 코드 테스팅 

* ```bash
  git checkout -f d249c72
  ```

##### 이벤트 처리기 동작 코드 테스팅

* 마크업에 할당문을 넣지 말고 모듈 스스로 타깃 요소의 클릭 처리기로 할당할 수 있게 만들자 

* ```bash
  git checkout -f 6d75e7b
  ```


### [실습1] BgColorSettingDisplay

* // todo

### [실습2] SidebarDisplay

* // todo

## 콜백 패턴 테스트 

### CardService

* // todo 

### LocalStorage

* // todo 

## XMLHttpRequest 테스트

### CardApi 

* // todo 

## 정리  

* TDD를 통해...
* BgColorSetting

## 참고 자료

* 자바스크립트 패턴과 테스트 (도서, 래리 스펜서, 세스 리쳐즈 지음, 이일웅 길벗)
* Jasmine 자바스크립트 테스팅 (도서, 파울로 라고나 지음, 이일웅 옮김, 에이콘)